<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>H·ªì S∆° T·ª≠ Nghi·ªám - Tactical Detective</title>
    <link href="https://fonts.googleapis.com/css2?family=Space+Mono&family=Quicksand:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --neon-red: #ff3131; --neon-blue: #00d4ff; --gold: #ffd700;
            --bg: #05050a; --glass: rgba(15, 15, 25, 0.95);
        }
        body { font-family: 'Quicksand', sans-serif; background: var(--bg); color: #fff; margin: 0; height: 100vh; display: flex; justify-content: center; align-items: center; overflow: hidden; }
        .container { width: 95%; max-width: 500px; background: var(--glass); padding: 1.5rem; border-radius: 24px; border: 1px solid rgba(0, 212, 255, 0.2); position: relative; backdrop-filter: blur(15px); text-align: center; }
        .screen { display: none; animation: fadeIn 0.4s ease; }
        .active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }

        /* Stats & Timer */
        .stats-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; background: rgba(255,255,255,0.05); padding: 10px; border-radius: 12px; font-size: 0.8rem; }
        #timer-bar { width: 100%; height: 5px; background: #222; margin-bottom: 15px; border-radius: 3px; overflow: hidden; }
        #timer-progress { width: 100%; height: 100%; background: var(--neon-blue); transition: width 1s linear; }

        /* Items */
        .item-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin: 20px 0; }
        .item-card { background: rgba(255,255,255,0.05); border: 1px solid #333; padding: 10px; border-radius: 10px; cursor: pointer; font-size: 0.7rem; transition: 0.3s; }
        .item-card.selected { border-color: var(--gold); background: rgba(255, 215, 0, 0.1); box-shadow: 0 0 10px var(--gold); }
        
        #use-item-btn { background: var(--gold); color: #000; font-size: 0.7rem; width: auto; padding: 8px 12px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; }
        #use-item-btn:disabled { opacity: 0.5; cursor: not-allowed; background: #555; }

        .lore-box { background: rgba(0,0,0,0.4); padding: 12px; border-radius: 10px; border-left: 3px solid var(--neon-blue); margin-bottom: 10px; font-size: 0.8rem; text-align: left; min-height: 40px; }
        button { width: 100%; padding: 12px; margin: 5px 0; background: var(--neon-red); color: white; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; transition: 0.2s; }
        button:hover { opacity: 0.8; }
        .option-btn { background: transparent; border: 1px solid var(--neon-blue); }
        .wrong { opacity: 0.3; pointer-events: none; border-color: #444; color: #444; }
    </style>
</head>
<body>

    <div class="container">
        <div id="start-screen" class="screen active">
            <h1 style="color:var(--neon-blue);">DETECTIVE CORE</h1>
            <input type="text" id="username" placeholder="M·∫¨T DANH..." style="width:70%; padding:10px; border-radius:8px; border:1px solid #333; background:#000; color:white; text-align:center; margin-bottom: 10px;">
            
            <p style="font-size: 0.8rem; margin-top: 15px;">CH·ªåN TRANG B·ªä TR·ª¢ GI√öP (H·ªíI M·ªñI M√ÄN):</p>
            <div class="item-grid">
                <div class="item-card" onclick="selectItem('k√≠nh l√∫p', this)">üîç<br>K√≠nh L√∫p<br>(X√≥a 1 sai)</div>
                <div class="item-card" onclick="selectItem('m√°y qu√©t', this)">üìü<br>M√°y Qu√©t<br>(+15s time)</div>
                <div class="item-card" onclick="selectItem('s·ªï tay', this)">üìì<br>S·ªï Tay<br>(+1 M·∫°ng)</div>
            </div>
            
            <button onclick="startGame()">V√ÄO HI·ªÜN TR∆Ø·ªúNG</button>
        </div>

        <div id="game-screen" class="screen">
            <div class="stats-bar">
                <div id="lives-display">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</div>
                <div style="color: var(--gold);"><span id="coin-val">0</span> ü™ô</div>
                <div style="color: var(--neon-blue);">‚è±Ô∏è <span id="timer-text">30</span>s</div>
            </div>
            <div id="timer-bar"><div id="timer-progress"></div></div>
            
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                <div id="level-title" style="color:var(--neon-blue); font-size: 0.8rem; font-weight: bold;"></div>
                <button id="use-item-btn" onclick="useItem()">S·ª¨ D·ª§NG V·∫¨T PH·∫®M</button>
            </div>

            <div class="lore-box" id="lore-text"></div>
            <div id="question-text" style="font-weight: bold; margin-bottom: 15px;"></div>
            <div id="options-container"></div>
        </div>

        <div id="victory-screen" class="screen">
            <h1 style="color:var(--gold);">MISSION COMPLETE</h1>
            <div id="final-stats"></div>
            <button onclick="location.reload()">L√ÄM NHI·ªÜM V·ª§ M·ªöI</button>
        </div>
    </div>

    <script>
        let currentLvl = 0, lives = 3, coins = 0, timeLeft = 30, timerInterval;
        let selectedItem = null;
        let itemUsedInThisLevel = false;
        const quizData = [
    // --- CH∆Ø∆†NG 1: HI·ªÜN TR∆Ø·ªúNG S∆† C·∫§P ---
    { t: "M√ÄN 1", l: "V·∫øt s∆°n ƒê·ªè ƒë√® l√™n V√†ng t·∫°i c·ª≠a ra v√†o.", q: "M√†u s·∫Øc c·ªßa k·∫ª t√¨nh nghi l√†?", opt: ["T√≠m", "Cam", "L·ª•c", "X√°m"], a: 1 },
    { t: "M√ÄN 2", l: "N·∫°n nh√¢n b·ªã ƒë·∫ßu ƒë·ªôc l√∫c 12h tr∆∞a, c·ªëc cafe tr√™n b√†n v·∫´n c√≤n b·ªëc h∆°i n√≥ng.", q: "Th·ªùi ƒëi·ªÉm th√°m t·ª≠ ƒë·∫øn l√†?", opt: ["3h chi·ªÅu", "6h t·ªëi", "12h05 tr∆∞a", "9h s√°ng"], a: 2 },
    { t: "M√ÄN 3", l: "C·ª≠a k√≠nh b·ªã v·ª° t·ª´ b√™n trong, m·∫£nh v·ª° vƒÉng h·∫øt ra s√¢n v∆∞·ªùn.", q: "K·∫ª tr·ªôm ƒë·ªôt nh·∫≠p t·ª´ ƒë√¢u?", opt: ["T·ª´ ngo√†i v√†o", "T·ª´ trong ra", "Qua ·ªëng kh√≥i", "Kh√¥ng c√≥ tr·ªôm"], a: 1 },
    { t: "M√ÄN 4", l: "N·∫°n nh√¢n vi·∫øt ch·ªØ 'H' b·∫±ng tay tr√°i, nh∆∞ng chi·∫øc ƒë·ªìng h·ªì l·∫°i ƒëeo ·ªü tay tr√°i.", q: "ƒêi·ªÉm b·∫•t th∆∞·ªùng l√†?", opt: ["ƒêeo ƒë·ªìng h·ªì", "Vi·∫øt ch·ªØ", "Thu·∫≠n tay", "Kh√¥ng c√≥"], a: 2 },
    { t: "M√ÄN 5", l: "B√≥ng c·ªßa c√°i c√¢y ƒë·ªï v·ªÅ ph√≠a ƒê√¥ng r·∫•t d√†i.", q: "L√∫c n√†y l√† th·ªùi ƒëi·ªÉm n√†o?", opt: ["B√¨nh minh", "Ho√†ng h√¥n", "Ch√≠nh ng·ªç", "N·ª≠a ƒë√™m"], a: 1 },
    { t: "M√ÄN 6", l: "D·∫•u ch√¢n c·ª° 43 t·∫°i hi·ªán tr∆∞·ªùng, trong khi ch·ªß nh√† ƒëi c·ª° 39.", q: "K·∫ª ƒë·ªôt nh·∫≠p l√†?", opt: ["Ch·ªß nh√†", "Ng∆∞·ªùi l·∫°", "Tr·∫ª em", "Th√∫ c∆∞ng"], a: 1 },

    // --- CH∆Ø∆†NG 2: M·∫¨T M√É LOGIC ---
    { t: "M√ÄN 7", l: "M·∫≠t m√£ Caesar (L√πi 1 b∆∞·ªõc): D-P-V.", q: "Thi·∫øt b·ªã b·ªã ƒë√°nh c·∫Øp?", opt: ["CPU", "BOU", "CAT", "RAM"], a: 0 },
    { t: "M√ÄN 8", l: "S·ªë nh·ªã ph√¢n '1010' ghi tr√™n t∆∞·ªùng.", q: "Con s·ªë n√†y ·ªü h·ªá th·∫≠p ph√¢n l√†?", opt: ["8", "10", "12", "14"], a: 1 },
    { t: "M√ÄN 9", l: "M·∫≠t m√£ b√†n ph√≠m ƒëi·ªán tho·∫°i c·ªï: 2-2-2.", q: "Ch·ªØ c√°i t∆∞∆°ng ·ª©ng l√†?", opt: ["A", "B", "C", "D"], a: 2 },
    { t: "M√ÄN 10", l: "D√≤ng ch·ªØ vi·∫øt ng∆∞·ª£c qua g∆∞∆°ng: 'MAI'.", q: "T√™n th·∫≠t c·ªßa n·∫°n nh√¢n l√†?", opt: ["IAM", "AMI", "MIA", "MAI"], a: 0 },
    { t: "M√ÄN 11", l: "S·ªë th·ª© t·ª± b·∫£ng ch·ªØ c√°i: 1-16-16-12-5.", q: "T·ª´ gi·∫£i m√£ ƒë∆∞·ª£c l√†?", opt: ["APPLE", "BANAN", "ORANG", "GRAPE"], a: 0 },
    { t: "M√ÄN 12", l: "M·∫≠t m√£ ƒë·∫£o ng∆∞·ª£c: 'NEPO'.", q: "Tr·∫°ng th√°i c·ªßa c·ª≠a?", opt: ["ƒê√≥ng", "M·ªü", "Kh√≥a", "H·ªèng"], a: 1 },

    // --- CH∆Ø∆†NG 3: KI·∫æN TH·ª®C PH√ÅP Y ---
    { t: "M√ÄN 13", l: "N·∫°n nh√¢n t·ª≠ vong trong ph√≤ng k√≠n, nhi·ªát ƒë·ªô c∆° th·ªÉ h·∫° xu·ªëng 0¬∞C.", q: "M√¥i tr∆∞·ªùng g√¢y t·ª≠ vong?", opt: ["N√≥ng", "L·∫°nh", "√Åp su·∫•t", "H√≥a ch·∫•t"], a: 1 },
    { t: "M√ÄN 14", l: "V·∫øt m√°u t·∫°i hi·ªán tr∆∞·ªùng c√≥ nh√≥m m√°u chuy√™n cho.", q: "Nh√≥m m√°u ƒë√≥ l√†?", opt: ["A", "B", "AB", "O"], a: 3 },
    { t: "M√ÄN 15", l: "Ch·∫•t l·ªèng b·∫°c ch·∫£y ra t·ª´ nhi·ªát k·∫ø v·ª°.", q: "ƒê√¢y l√† kim lo·∫°i ƒë·ªôc h·∫°i n√†o?", opt: ["Ch√¨", "S·∫Øt", "Th·ªßy ng√¢n", "ƒê·ªìng"], a: 2 },
    { t: "M√ÄN 16", l: "X√°c ch·∫øt b·∫Øt ƒë·∫ßu co c·ª©ng ho√†n to√†n sau 12 ti·∫øng.", q: "Hi·ªán t∆∞·ª£ng n√†y g·ªçi l√†?", opt: ["Ph√¢n h·ªßy", "Co c·ª©ng t·ª≠ thi", "H√≥a th·∫°ch", "ƒê√¥ng m√°u"], a: 1 },
    { t: "M√ÄN 17", l: "Hung th·ªß d√πng Axit ƒë·ªÉ phi tang v·∫≠t ch·ª©ng.", q: "D√πng gi·∫•y qu·ª≥ t√≠m th·ª≠ s·∫Ω th·∫•y?", opt: ["H√≥a xanh", "H√≥a ƒë·ªè", "M·∫•t m√†u", "Kh√¥ng ƒë·ªïi"], a: 1 },
    { t: "M√ÄN 18", l: "V·∫øt th∆∞∆°ng c√≥ h√¨nh tr√≤n nh·ªè, xuy√™n th·∫•u.", q: "V≈© kh√≠ kh·∫£ nghi nh·∫•t?", opt: ["Dao", "B√∫a", "S√∫ng", "D√¢y th·ª´ng"], a: 2 },

    // --- CH∆Ø∆†NG 4: T√ÇM L√ù T·ªòI PH·∫†M ---
    { t: "M√ÄN 19", l: "Nh√¢n ch·ª©ng n√≥i: 'T√¥i th·∫•y h·∫Øn ta ƒë·ª©ng d∆∞·ªõi trƒÉng l√∫c 12h tr∆∞a'.", q: "L·ªùi khai n√†y l√†?", opt: ["Th·∫≠t", "D·ªëi", "Nh·∫ßm l·∫´n", "B√¨nh th∆∞·ªùng"], a: 1 },
    { t: "M√ÄN 20", l: "K·∫ª t√¨nh nghi li√™n t·ª•c g√£i m≈©i v√† tr√°nh √°nh m·∫Øt th√°m t·ª≠.", q: "T√¢m l√Ω n√†y bi·ªÉu hi·ªán?", opt: ["T·ª± tin", "Lo l·∫Øng/D·ªëi", "Vui v·∫ª", "Gi·∫≠n d·ªØ"], a: 1 },
    { t: "M√ÄN 21", l: "K·∫ª tr·ªôm ch·ªâ l·∫•y ƒëi nh·ªØng t·∫•m ·∫£nh c≈©, b·ªè qua v√†ng b·∫°c.", q: "ƒê·ªông c∆° l√†?", opt: ["T√†i ch√≠nh", "T√¨nh c·∫£m/K·ª∑ ni·ªám", "Nh·∫ßm l·∫´n", "Th√°ch th·ª©c"], a: 1 },
    { t: "M√ÄN 22", l: "Hung th·ªß ƒë·ªÉ l·∫°i l·ªùi nh·∫Øn: 'C√¢u n√†y l√† n√≥i d·ªëi'.", q: "Logic n√†y g·ªçi l√†?", opt: ["S·ª± th·∫≠t", "N√≥i d·ªëi", "Ngh·ªãch l√Ω", "Kh·∫≥ng ƒë·ªãnh"], a: 2 },
    { t: "M√ÄN 23", l: "M·ªôt ng∆∞·ªùi ƒë·ª©ng d∆∞·ªõi m∆∞a 30 ph√∫t nh∆∞ng t√≥c kh√¥ nguy√™n.", q: "V√¨ sao?", opt: ["M∆∞a gi·∫£", "H√≥i ƒë·∫ßu/ƒê·ªôi m≈©", "Ch·∫°y nhanh", "N√≠n th·ªü"], a: 1 },
    { t: "M√ÄN 24", l: "K·∫ª s√°t nh√¢n th∆∞·ªùng quay l·∫°i n∆°i g√¢y √°n v√¨?", opt: ["Qu√™n ƒë·ªì", "T·ª± m√£n/Quan s√°t", "ƒÇn nƒÉn", "ƒê·∫ßu th√∫"], a: 1 },

    // --- CH∆Ø∆†NG 5: ƒê·∫†I TH√ÅM T·ª¨ ---
    { t: "M√ÄN 25", l: "D√£y s·ªë t·∫°i m·∫≠t th·∫•t: 1, 1, 2, 3, 5, 8...", q: "S·ªë ti·∫øp theo l√†?", opt: ["11", "12", "13", "15"], a: 2 },
    { t: "M√ÄN 26", l: "T√≠n hi·ªáu ƒë√®n: Ng·∫Øn-Ng·∫Øn-Ng·∫Øn | D√†i-D√†i-D√†i | Ng·∫Øn-Ng·∫Øn-Ng·∫Øn.", q: "Th√¥ng ƒëi·ªáp l√†?", opt: ["HELLO", "SOS", "HELP", "FIRE"], a: 1 },
    { t: "M√ÄN 27", l: "V·∫øt m√°u vƒÉng h√¨nh gi·ªçt n∆∞·ªõc c√≥ ƒëu√¥i h∆∞·ªõng v·ªÅ b√™n ph·∫£i.", q: "Hung th·ªß di chuy·ªÉn v·ªÅ ph√≠a?", opt: ["Tr√°i", "Ph·∫£i", "ƒê·ª©ng y√™n", "L√™n tr√™n"], a: 1 },
    { t: "M√ÄN 28", l: "Trong ph√≤ng c√≥ 3 ng∆∞·ªùi: A n√≥i B n√≥i d·ªëi, B n√≥i C n√≥i d·ªëi, C n√≥i A v√† B n√≥i d·ªëi.", q: "Ai n√≥i th·∫≠t?", opt: ["A", "B", "C", "Kh√¥ng ai"], a: 1 },
    { t: "M√ÄN 29", l: "ƒê·ªìng h·ªì c√°t 10 ph√∫t ƒë√£ ch·∫£y h·∫øt, n·∫øn ch√°y ƒë∆∞·ª£c m·ªôt n·ª≠a.", q: "Hung th·ªß ƒë√£ ·ªü ƒë√¢y √≠t nh·∫•t bao l√¢u?", opt: ["5 ph√∫t", "10 ph√∫t", "20 ph√∫t", "1 ti·∫øng"], a: 1 },
    { t: "M√ÄN 30", l: "Manh m·ªëi cu·ªëi: K·∫ª ƒë·ª©ng sau t·∫•t c·∫£ l√† ng∆∞·ªùi ƒë√£ xu·∫•t hi·ªán ·ªü M√†n 1.", q: "H·∫Øn l√† ai?", opt: ["N·∫°n nh√¢n", "Th√°m t·ª≠", "Hung th·ªß s∆°n cam", "Ng∆∞·ªùi qua ƒë∆∞·ªùng"], a: 2 }
];

        function selectItem(item, el) {
            selectedItem = item;
            document.querySelectorAll('.item-card').forEach(card => card.classList.remove('selected'));
            el.classList.add('selected');
        }

        function startGame() {
            if(!document.getElementById('username').value) return alert("Nh·∫≠p m·∫≠t danh!");
            if(!selectedItem) return alert("H√£y ch·ªçn m·ªôt v·∫≠t ph·∫©m h·ªó tr·ª£!");
            
            document.getElementById('start-screen').classList.remove('active');
            document.getElementById('game-screen').classList.add('active');
            loadLevel();
        }

        function loadLevel() {
            if(currentLvl >= quizData.length) return showVictory();
            
            // Reset tr·∫°ng th√°i v·∫≠t ph·∫©m cho m·ªói m√†n m·ªõi
            itemUsedInThisLevel = false;
            const itemBtn = document.getElementById('use-item-btn');
            itemBtn.disabled = false;
            itemBtn.innerText = "D√ôNG " + selectedItem.toUpperCase();

            const data = quizData[currentLvl];
            document.getElementById('level-title').innerText = data.t;
            document.getElementById('lore-text').innerText = data.l;
            document.getElementById('question-text').innerText = data.q;
            
            const container = document.getElementById('options-container');
            container.innerHTML = "";
            data.opt.forEach((o, i) => {
                const btn = document.createElement('button');
                btn.className = "option-btn";
                btn.innerText = o;
                btn.onclick = () => check(i);
                container.appendChild(btn);
            });
            
            resetTimer();
        }

        function resetTimer() {
            clearInterval(timerInterval);
            timeLeft = 30;
            updateTimerUI();
            timerInterval = setInterval(() => {
                timeLeft--;
                updateTimerUI();
                if(timeLeft <= 0) {
                    handleWrong();
                }
            }, 1000);
        }

        function updateTimerUI() {
            document.getElementById('timer-text').innerText = timeLeft;
            const percent = (timeLeft / 30) * 100;
            const bar = document.getElementById('timer-progress');
            bar.style.width = percent + "%";
            bar.style.background = timeLeft < 10 ? "var(--neon-red)" : "var(--neon-blue)";
        }

        function useItem() {
            if(itemUsedInThisLevel) return;
            itemUsedInThisLevel = true;
            
            const itemBtn = document.getElementById('use-item-btn');
            itemBtn.disabled = true;
            itemBtn.innerText = "ƒê√É D√ôNG";

            if(selectedItem === 'k√≠nh l√∫p') {
                const btns = document.querySelectorAll('.option-btn');
                const correctIdx = quizData[currentLvl].a;
                // T√¨m m·ªôt n√∫t kh√¥ng ph·∫£i ƒë√°p √°n ƒë√∫ng ƒë·ªÉ ·∫©n
                let randomWrong;
                do {
                    randomWrong = Math.floor(Math.random() * btns.length);
                } while (randomWrong === correctIdx);
                btns[randomWrong].classList.add('wrong');
            } else if(selectedItem === 'm√°y qu√©t') {
                timeLeft += 15;
                updateTimerUI();
            } else if(selectedItem === 's·ªï tay') {
                lives++;
                updateLivesUI();
            }
        }

        function check(idx) {
            if(idx === quizData[currentLvl].a) {
                coins += 100;
                document.getElementById('coin-val').innerText = coins;
                currentLvl++;
                loadLevel();
            } else {
                handleWrong();
            }
        }

        function handleWrong() {
            lives--;
            updateLivesUI();
            if(lives <= 0) {
                alert("GAME OVER! M·∫≠t danh c·ªßa b·∫°n ƒë√£ b·ªã l·ªô.");
                location.reload();
            } else {
                // Sang m√†n ti·∫øp theo n·∫øu sai ho·∫∑c h·∫øt gi·ªù
                currentLvl++;
                loadLevel();
            }
        }

        function updateLivesUI() {
            let h = "";
            for(let i=0; i<lives; i++) h += "‚ù§Ô∏è";
            document.getElementById('lives-display').innerText = h || "üñ§";
        }

        function showVictory() {
            clearInterval(timerInterval);
            document.getElementById('game-screen').classList.remove('active');
            document.getElementById('victory-screen').classList.add('active');
            document.getElementById('final-stats').innerHTML = `
                <p>Th√°m t·ª≠: <strong>${document.getElementById('username').value}</strong></p>
                <p>T·ªïng t√†i s·∫£n: <span style="color:var(--gold)">${coins} ü™ô</span></p>
                <p>Trang b·ªã ƒë√£ d√πng: ${selectedItem.toUpperCase()}</p>
            `;
        }
    </script>
</body>
</html>